{"ast":null,"code":"import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport React, { useCallback, useRef, useEffect, createContext, useState, useContext } from 'react';\nimport _extends from '@babel/runtime/helpers/extends';\nimport { useFormContext, useField } from '@kne/react-form';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport classnames from 'classnames';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport textWidth from '@kne/text-width';\nimport uniq from 'lodash/uniq';\nimport get from 'lodash/get';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar useBlurDecorator = function useBlurDecorator(_ref) {\n  var triggerValidate = _ref.triggerValidate,\n      onBlur = _ref.onBlur,\n      others = _objectWithoutProperties(_ref, [\"triggerValidate\", \"onBlur\"]);\n\n  var handlerBlur = useCallback(function () {\n    onBlur && onBlur.apply(void 0, arguments);\n    triggerValidate();\n  }, [onBlur, triggerValidate]);\n  return _objectSpread({\n    onBlur: handlerBlur\n  }, others);\n};\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$1(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$1(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar useChangeDecorator = function useChangeDecorator(_ref) {\n  var triggerValidate = _ref.triggerValidate,\n      value = _ref.value,\n      onChange = _ref.onChange,\n      others = _objectWithoutProperties(_ref, [\"triggerValidate\", \"value\", \"onChange\"]);\n\n  var hasChanged = useRef(false),\n      validate = useRef(void 0);\n  var handlerChange = useCallback(function () {\n    onChange && onChange.apply(void 0, arguments);\n    hasChanged.current = true;\n  }, [onChange]);\n  useEffect(function () {\n    validate.current = triggerValidate;\n  }, [triggerValidate]);\n  useEffect(function () {\n    hasChanged.current && validate.current();\n  }, [value]);\n  return _objectSpread$1({\n    value: value,\n    onChange: handlerChange\n  }, others);\n};\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys$2(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys$2(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar useCheckedToValue = function useCheckedToValue(_ref) {\n  var checked = _ref.checked,\n      props = _objectWithoutProperties(_ref, [\"checked\"]);\n\n  return _objectSpread$2({}, props, {\n    value: checked\n  });\n};\n\nvar withChecked = function withChecked(WrappedComponent) {\n  return function (_ref2) {\n    var value = _ref2.value,\n        props = _objectWithoutProperties(_ref2, [\"value\"]);\n\n    return React.createElement(WrappedComponent, _extends({}, props, {\n      checked: value\n    }));\n  };\n};\n\nvar context = createContext({});\nvar Provider = context.Provider;\n\nvar useMaxLabelWidth = function useMaxLabelWidth() {\n  var _useContext = useContext(context),\n      maxWidth = _useContext.maxWidth;\n\n  return maxWidth;\n};\n\nvar MaxLabelProvider = function MaxLabelProvider(_ref) {\n  var minLabelWidth = _ref.minLabelWidth,\n      children = _ref.children;\n\n  var _useState = useState(minLabelWidth || 0),\n      _useState2 = _slicedToArray(_useState, 2),\n      maxWidth = _useState2[0],\n      setMaxWidth = _useState2[1];\n\n  var _useFormContext = useFormContext(),\n      fields = _useFormContext.fields;\n\n  var root = useRef(null);\n  useEffect(function () {\n    var label = root.current.querySelector('.react-form__field-label') || root.current;\n    var fontSize = window.getComputedStyle(label).getPropertyValue('font-size');\n    setMaxWidth(Math.max.apply(Math, _toConsumableArray(uniq(Object.values(fields).map(function (_ref2) {\n      var label = _ref2.label;\n      return label;\n    })).map(function (str) {\n      return textWidth(str, fontSize);\n    }))));\n  }, [fields]);\n  return React.createElement(Provider, {\n    value: {\n      maxWidth: maxWidth,\n      setMaxWidth: setMaxWidth\n    }\n  }, React.createElement(\"span\", {\n    ref: root\n  }, children));\n};\n\nvar context$1 = createContext({\n  size: 'middle'\n});\nvar Provider$1 = context$1.Provider,\n    Consumer = context$1.Consumer;\n\nvar useFormSize = function useFormSize() {\n  var _useContext = useContext(context$1),\n      size = _useContext.size;\n\n  return size;\n};\n\nvar computedErrorClassName = function computedErrorClassName(_ref) {\n  var errMsg = _ref.errMsg,\n      errState = _ref.errState,\n      isSubmit = _ref.isSubmit,\n      isValueChanged = _ref.isValueChanged;\n  return {\n    'is-req-error': errMsg === '' && errState === 2 && (isSubmit || isValueChanged),\n    'is-error': errMsg !== '' && errState === 2,\n    'is-loading': errState === 3\n  };\n};\n\nvar useUIDecorator = function useUIDecorator(props) {\n  var name = props.name,\n      rule = props.rule,\n      className = props.className,\n      onChange = props.onChange,\n      label = props.label,\n      labelHidden = props.labelHidden,\n      errMsg = props.errMsg,\n      errState = props.errState,\n      isValueChanged = props.isValueChanged,\n      wrappedClassName = props.wrappedClassName,\n      fieldRef = props.fieldRef,\n      important = props.important,\n      ignoreLabelWidth = props.ignoreLabelWidth,\n      formState = props.formState,\n      groupIndex = props.groupIndex,\n      groupName = props.groupName,\n      formData = props.formData,\n      others = _objectWithoutProperties(props, [\"name\", \"rule\", \"className\", \"onChange\", \"label\", \"labelHidden\", \"errMsg\", \"errState\", \"isValueChanged\", \"wrappedClassName\", \"fieldRef\", \"important\", \"ignoreLabelWidth\", \"formState\", \"groupIndex\", \"groupName\", \"formData\"]);\n\n  var size = useFormSize();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isREQ = _useState2[0],\n      setIsREQ = _useState2[1],\n      _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isSubmit = _useState4[0],\n      setIsSubmit = _useState4[1];\n\n  var _useFormContext = useFormContext(),\n      emitter = _useFormContext.emitter;\n\n  var labelWidth = useMaxLabelWidth();\n  useEffect(function () {\n    setIsREQ((rule || '').split(' ').indexOf('REQ') > -1);\n  }, [setIsREQ, name, rule]); //当表单提交时设置状态\n\n  useEffect(function () {\n    var subscription = emitter.addListener('form-submit', function () {\n      setIsSubmit(true);\n    });\n    return function () {\n      subscription && subscription.remove();\n    };\n  }, [emitter, name]);\n  var handlerChange = useCallback(function () {\n    onChange.apply(void 0, arguments);\n    setIsSubmit(false);\n  }, [onChange, setIsSubmit]);\n  return useCallback(function (WrappedComponent) {\n    var style = {};\n\n    if (!ignoreLabelWidth && labelWidth > 0) {\n      style.minWidth = labelWidth;\n    }\n\n    var stateClassName = computedErrorClassName({\n      errMsg: errMsg,\n      errState: errState,\n      isSubmit: isSubmit,\n      isValueChanged: isValueChanged\n    });\n    var isReq = important !== void 0 ? important : isREQ;\n\n    if (size) {\n      others.size = size;\n    }\n\n    return React.createElement(\"div\", {\n      ref: fieldRef,\n      className: classnames('react-form__field', {\n        'is-ignore-label-width': ignoreLabelWidth\n      }, wrappedClassName, stateClassName)\n    }, React.createElement(\"div\", {\n      className: \"react-form__field-main\"\n    }, label && !labelHidden ? React.createElement(\"div\", {\n      className: classnames('react-form__field-label', {\n        'is-req': isReq\n      }),\n      style: style\n    }, React.createElement(\"i\", {\n      className: \"react-form__field_extra\"\n    }), label) : null, React.createElement(\"div\", {\n      className: \"react-form__field-input\"\n    }, React.createElement(WrappedComponent, _extends({}, others, {\n      className: classnames('react-form__field-component', className),\n      onChange: handlerChange\n    })), errMsg ? React.createElement(\"div\", {\n      className: \"react-form__field-error\"\n    }, errMsg) : null)));\n  }, [labelWidth, fieldRef, labelHidden, ignoreLabelWidth, others, isValueChanged, className, errMsg, errState, handlerChange, important, isREQ, isSubmit, label, wrappedClassName]);\n};\n\nvar useDecorator = function useDecorator(_ref) {\n  var realtime = _ref.realtime,\n      props = _objectWithoutProperties(_ref, [\"realtime\"]);\n\n  var fieldProps = useField(Object.assign(realtime ? {\n    debounce: 500\n  } : {}, props)),\n      changeProps = useChangeDecorator(fieldProps),\n      blurProps = useBlurDecorator(fieldProps),\n      realtimeProps = Object.assign({}, blurProps, changeProps);\n  return useUIDecorator(realtime ? realtimeProps : blurProps);\n};\n\nvar useOnChange = function useOnChange(props) {\n  var fieldProps = useField(props),\n      changeProps = useChangeDecorator(fieldProps);\n  return useUIDecorator(changeProps);\n};\n\nvar useOnBlur = function useOnBlur(props) {\n  var fieldProps = useField(props),\n      blurProps = useBlurDecorator(fieldProps);\n  return useUIDecorator(blurProps);\n};\n\nvar isElementInViewport = function isElementInViewport(el) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var box = el.getBoundingClientRect(),\n      top = box.top >= 0,\n      left = box.left >= 0,\n      bottom = box.bottom <= (window.innerHeight || document.documentElement.clientHeight) + offset,\n      right = box.right <= (window.innerWidth || document.documentElement.clientWidth) + offset;\n  return top && left && bottom && right;\n};\n\nvar ScrollToError = function ScrollToError(_ref) {\n  var scrollProps = _ref.scrollProps;\n\n  var _useFormContext = useFormContext(),\n      emitter = _useFormContext.emitter;\n\n  useEffect(function () {\n    var subscription = emitter.addListener('form-submit-error', function (errors) {\n      var el = get(errors, 'errors[0].fieldRef.current');\n      el && !isElementInViewport(el) && el.scrollIntoView(scrollProps);\n    });\n    return function () {\n      subscription && subscription.remove();\n    };\n  }, [emitter]);\n  return null;\n};\n\nScrollToError.defaultProps = {\n  scrollProps: {}\n};\n\nvar EnterSubmit = function EnterSubmit(_ref) {\n  var type = _ref.type,\n      children = _ref.children,\n      props = _objectWithoutProperties(_ref, [\"type\", \"children\"]);\n\n  var _useFormContext = useFormContext(),\n      emitter = _useFormContext.emitter;\n\n  var handlerKeyUp = useCallback(function (e) {\n    if (e.keyCode === 13) {\n      emitter.emit('form-submit');\n    }\n  }, [emitter]);\n  return React.createElement(type, Object.assign({}, props, {\n    onKeyUp: handlerKeyUp\n  }), children);\n};\n\nEnterSubmit.defaultProps = {\n  type: 'div'\n};\n\nvar FormStore = function FormStore(_ref) {\n  var cache = _ref.cache;\n  var name = useRef(\"REACT_FORM_STORE_\".concat(cache));\n\n  var _useFormContext = useFormContext(),\n      emitter = _useFormContext.emitter;\n\n  useEffect(function () {\n    try {\n      var data = window.localStorage.getItem(name.current);\n\n      if (data) {\n        var parseData = JSON.parse(data);\n        setTimeout(function () {\n          emitter.emit('form-data-set', {\n            data: parseData\n          });\n        }, 0);\n      }\n    } catch (e) {}\n\n    var subscriptionChange = emitter.addListener('form-state-change', function (_ref2) {\n      var data = _ref2.data;\n      var preData = window.localStorage.getItem(name.current),\n          parseData = JSON.stringify(data);\n      preData !== parseData && window.localStorage.setItem(name.current, parseData);\n    });\n    var subscriptionSubmit = emitter.addListener('form-submit-success', function () {\n      window.localStorage.removeItem(name.current);\n    });\n    return function () {\n      subscriptionChange && subscriptionChange.remove();\n      subscriptionSubmit && subscriptionSubmit.remove();\n    };\n  }, [emitter]);\n  return null;\n};\n\nvar hooks = {\n  useBlurDecorator: useBlurDecorator,\n  useChangeDecorator: useChangeDecorator,\n  useCheckedToValue: useCheckedToValue,\n  useDecorator: useDecorator,\n  useOnBlur: useOnBlur,\n  useOnChange: useOnChange,\n  useUIDecorator: useUIDecorator\n};\nvar hoc = {\n  withChecked: withChecked\n};\nvar widget = {\n  ScrollToError: ScrollToError,\n  EnterSubmit: EnterSubmit,\n  MaxLabelProvider: MaxLabelProvider,\n  FormStore: FormStore,\n  SizeProvider: Provider$1\n};\nvar utils = {\n  isElementInViewport: isElementInViewport\n};\nvar api = {\n  hooks: hooks,\n  hoc: hoc,\n  widget: widget,\n  utils: utils\n};\nexport default api;\nexport { hoc, hooks, utils, widget };","map":{"version":3,"sources":["../src/hooks/useBlurDecorator.js","../src/hooks/useChangeDecorator.js","../src/hooks/useCheckedToValue.js","../src/widget/MaxLabelProvider.js","../src/widget/SizeProvider.js","../src/hooks/useUIDecorator.js","../src/hooks/useDecorator.js","../src/utils/isElementInViewport.js","../src/widget/ScrollToError.js","../src/widget/EnterSubmit.js","../src/widget/FormStore.js","../src/index.js"],"names":["useBlurDecorator","triggerValidate","onBlur","others","handlerBlur","useCallback","useChangeDecorator","value","onChange","hasChanged","useRef","validate","handlerChange","useEffect","useCheckedToValue","checked","props","withChecked","context","createContext","Provider","useMaxLabelWidth","maxWidth","useContext","MaxLabelProvider","minLabelWidth","children","setMaxWidth","useState","fields","useFormContext","root","label","fontSize","window","Math","textWidth","size","Consumer","useFormSize","computedErrorClassName","errMsg","errState","isSubmit","isValueChanged","useUIDecorator","name","rule","className","labelHidden","wrappedClassName","fieldRef","important","ignoreLabelWidth","formState","groupIndex","groupName","formData","isREQ","setIsREQ","setIsSubmit","emitter","labelWidth","subscription","style","stateClassName","isReq","classnames","useDecorator","realtime","fieldProps","useField","debounce","changeProps","blurProps","realtimeProps","Object","useOnChange","useOnBlur","isElementInViewport","offset","box","el","top","left","bottom","document","right","ScrollToError","scrollProps","get","EnterSubmit","type","handlerKeyUp","e","onKeyUp","FormStore","cache","data","parseData","JSON","setTimeout","subscriptionChange","preData","subscriptionSubmit","hooks","hoc","widget","SizeProvider","utils","api"],"mappings":"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","sourcesContent":["import {useCallback} from 'react';\n\nconst useBlurDecorator = ({triggerValidate, onBlur, ...others}) => {\n    const handlerBlur = useCallback((...args) => {\n        onBlur && onBlur(...args);\n        triggerValidate();\n    }, [onBlur, triggerValidate]);\n    return {\n        onBlur: handlerBlur,\n        ...others\n    };\n};\n\nexport default useBlurDecorator;","import {useRef, useEffect, useCallback} from 'react';\n\nconst useChangeDecorator = ({triggerValidate, value, onChange, ...others}) => {\n    const hasChanged = useRef(false), validate = useRef(void (0));\n    const handlerChange = useCallback((...args) => {\n        onChange && onChange(...args);\n        hasChanged.current = true;\n    }, [onChange]);\n\n    useEffect(() => {\n        validate.current = triggerValidate;\n    }, [triggerValidate]);\n\n    useEffect(() => {\n        hasChanged.current && validate.current();\n    }, [value]);\n\n    return {\n        value,\n        onChange: handlerChange,\n        ...others\n    };\n}\n\nexport default useChangeDecorator;\n","import React from 'react';\n\nconst useCheckedToValue = ({checked, ...props}) => {\n    return {\n        ...props,\n        value: checked\n    };\n};\n\nexport default useCheckedToValue;\n\nexport const withChecked = (WrappedComponent) => {\n    return ({value, ...props}) => <WrappedComponent {...props} checked={value}/>\n};","import React, {useState, useContext, createContext, useEffect, useRef} from 'react';\nimport textWidth from \"@kne/text-width\";\nimport {useFormContext} from \"@kne/react-form\";\nimport uniq from 'lodash/uniq';\n\nconst context = createContext({});\n\nconst {Provider} = context;\n\nexport const useMaxLabelWidth = () => {\n    const {maxWidth} = useContext(context);\n    return maxWidth;\n};\n\nconst MaxLabelProvider = ({minLabelWidth, children}) => {\n    const [maxWidth, setMaxWidth] = useState(minLabelWidth || 0);\n    const {fields} = useFormContext();\n    const root = useRef(null);\n    useEffect(() => {\n        const label = (root.current.querySelector('.react-form__field-label')||root.current);\n        const fontSize = window\n            .getComputedStyle(label)\n            .getPropertyValue('font-size');\n        setMaxWidth(Math.max(...uniq(Object.values(fields).map(({label}) => label)).map((str)=>textWidth(str,fontSize))));\n    }, [fields]);\n    return <Provider value={{maxWidth, setMaxWidth}}>\n        <span ref={root}>\n            {children}\n        </span>\n    </Provider>\n};\n\nexport default MaxLabelProvider;","import {createContext, useContext} from 'react';\n\nconst context = createContext({size: 'middle'});\n\nconst {Provider, Consumer} = context;\n\nexport const useFormSize = () => {\n    const {size} = useContext(context);\n    return size;\n};\n\nexport default Provider;","import React, { useState, useCallback, useEffect } from 'react';\nimport classnames from 'classnames';\nimport { useMaxLabelWidth } from '../widget/MaxLabelProvider';\nimport { useFormContext } from '@kne/react-form';\nimport { useFormSize } from '../widget/SizeProvider';\n\nconst computedErrorClassName = ({ errMsg, errState, isSubmit, isValueChanged }) => {\n  return {\n    'is-req-error': errMsg === '' && errState === 2 && (isSubmit || isValueChanged),\n    'is-error': errMsg !== '' && errState === 2,\n    'is-loading': errState === 3\n  };\n};\n\nconst useUIDecorator = props => {\n  const { name, rule, className, onChange, label, labelHidden, errMsg, errState, isValueChanged, wrappedClassName, fieldRef, important, ignoreLabelWidth, formState, groupIndex, groupName, formData, ...others } = props;\n  const size = useFormSize();\n  const [isREQ, setIsREQ] = useState(false),\n    [isSubmit, setIsSubmit] = useState(false);\n  const { emitter } = useFormContext();\n  const labelWidth = useMaxLabelWidth();\n  useEffect(() => {\n    setIsREQ((rule || '').split(' ').indexOf('REQ') > -1);\n  }, [setIsREQ, name, rule]);\n\n  //当表单提交时设置状态\n  useEffect(() => {\n    const subscription = emitter.addListener('form-submit', () => {\n      setIsSubmit(true);\n    });\n    return () => {\n      subscription && subscription.remove();\n    };\n  }, [emitter, name]);\n\n  const handlerChange = useCallback(\n    (...args) => {\n      onChange(...args);\n      setIsSubmit(false);\n    },\n    [onChange, setIsSubmit]\n  );\n\n  return useCallback(\n    WrappedComponent => {\n      const style = {};\n\n      if (!ignoreLabelWidth && labelWidth > 0) {\n        style.minWidth = labelWidth;\n      }\n\n      const stateClassName = computedErrorClassName({ errMsg, errState, isSubmit, isValueChanged });\n      const isReq = important !== void 0 ? important : isREQ;\n      if (size) {\n        others.size = size;\n      }\n      return (\n        <div\n          ref={fieldRef}\n          className={classnames(\n            'react-form__field',\n            {\n              'is-ignore-label-width': ignoreLabelWidth\n            },\n            wrappedClassName,\n            stateClassName\n          )}>\n          <div className=\"react-form__field-main\">\n            {label && !labelHidden ? (\n              <div className={classnames('react-form__field-label', { 'is-req': isReq })} style={style}>\n                <i className=\"react-form__field_extra\" />\n                {label}\n              </div>\n            ) : null}\n            <div className=\"react-form__field-input\">\n              <WrappedComponent {...others} className={classnames('react-form__field-component', className)} onChange={handlerChange} />\n              {errMsg ? <div className=\"react-form__field-error\">{errMsg}</div> : null}\n            </div>\n          </div>\n        </div>\n      );\n    },\n    [labelWidth, fieldRef, labelHidden, ignoreLabelWidth, others, isValueChanged, className, errMsg, errState, handlerChange, important, isREQ, isSubmit, label, wrappedClassName]\n  );\n};\n\nexport default useUIDecorator;\n","import {useField} from '@kne/react-form';\nimport useUIDecorator from './useUIDecorator';\nimport useBlurDecorator from './useBlurDecorator';\nimport useChangeDecorator from './useChangeDecorator';\n\nconst useDecorator = ({realtime, ...props}) => {\n    const fieldProps = useField(Object.assign(realtime ? {debounce: 500} : {}, props)),\n        changeProps = useChangeDecorator(fieldProps),\n        blurProps = useBlurDecorator(fieldProps),\n        realtimeProps = Object.assign({}, blurProps, changeProps);\n    return useUIDecorator(realtime ? realtimeProps : blurProps);\n};\n\nexport default useDecorator;\n\nexport const useOnChange = (props) => {\n    const fieldProps = useField(props),\n        changeProps = useChangeDecorator(fieldProps);\n    return useUIDecorator(changeProps);\n};\n\nexport const useOnBlur = (props) => {\n    const fieldProps = useField(props),\n        blurProps = useBlurDecorator(fieldProps);\n    return useUIDecorator(blurProps);\n};","const isElementInViewport = (el, offset = 0) => {\n    const box = el.getBoundingClientRect(),\n        top = box.top >= 0,\n        left = box.left >= 0,\n        bottom =\n            box.bottom <=\n            (window.innerHeight || document.documentElement.clientHeight) + offset,\n        right =\n            box.right <=\n            (window.innerWidth || document.documentElement.clientWidth) + offset;\n    return top && left && bottom && right;\n};\n\nexport default isElementInViewport;","import { useEffect } from 'react';\nimport { useFormContext } from '@kne/react-form';\nimport isElementInViewport from '../utils/isElementInViewport';\nimport get from 'lodash/get';\n\nconst ScrollToError = ({ scrollProps }) => {\n  const { emitter } = useFormContext();\n  useEffect(() => {\n    const subscription = emitter.addListener('form-submit-error', errors => {\n        const el = get(errors, 'errors[0].fieldRef.current');\n        el && !isElementInViewport(el) && el.scrollIntoView(scrollProps);\n    });\n    return () => {\n      subscription && subscription.remove();\n    };\n  }, [emitter]);\n\n  return null;\n};\n\nScrollToError.defaultProps = {\n  scrollProps: {}\n};\n\nexport default ScrollToError;\n","import React, { useCallback } from 'react';\nimport { useFormContext } from '@kne/react-form';\n\nconst EnterSubmit = ({ type, children, ...props }) => {\n  const { emitter } = useFormContext();\n  const handlerKeyUp = useCallback(\n    e => {\n      if (e.keyCode === 13) {\n        emitter.emit('form-submit');\n      }\n    },\n    [emitter]\n  );\n\n  return React.createElement(\n    type,\n    Object.assign({}, props, {\n      onKeyUp: handlerKeyUp\n    }),\n    children\n  );\n};\n\nEnterSubmit.defaultProps = {\n  type: 'div'\n};\n\nexport default EnterSubmit;\n","import { useEffect, useRef } from 'react';\nimport { useFormContext } from '@kne/react-form';\n\nconst FormStore = ({ cache }) => {\n  const name = useRef(`REACT_FORM_STORE_${cache}`);\n  const { emitter } = useFormContext();\n  useEffect(() => {\n    try {\n      const data = window.localStorage.getItem(name.current);\n      if (data) {\n        const parseData = JSON.parse(data);\n        setTimeout(() => {\n          emitter.emit('form-data-set', { data: parseData });\n        }, 0);\n      }\n    } catch (e) {}\n\n    const subscriptionChange = emitter.addListener('form-state-change', ({ data }) => {\n      const preData = window.localStorage.getItem(name.current),\n        parseData = JSON.stringify(data);\n      preData !== parseData && window.localStorage.setItem(name.current, parseData);\n    });\n\n    const subscriptionSubmit = emitter.addListener('form-submit-success', () => {\n      window.localStorage.removeItem(name.current);\n    });\n\n    return () => {\n      subscriptionChange && subscriptionChange.remove();\n      subscriptionSubmit && subscriptionSubmit.remove();\n    };\n  }, [emitter]);\n  return null;\n};\n\nexport default FormStore;\n","import useBlurDecorator from './hooks/useBlurDecorator';\nimport useChangeDecorator from './hooks/useChangeDecorator';\nimport useCheckedToValue, {withChecked} from './hooks/useCheckedToValue';\nimport useDecorator, {useOnBlur, useOnChange} from './hooks/useDecorator';\nimport useUIDecorator from './hooks/useUIDecorator';\nimport ScrollToError from './widget/ScrollToError';\nimport EnterSubmit from './widget/EnterSubmit';\nimport MaxLabelProvider from './widget/MaxLabelProvider';\nimport SizeProvider from './widget/SizeProvider';\nimport FormStore from './widget/FormStore';\nimport isElementInViewport from './utils/isElementInViewport';\n\n\nexport const hooks = {\n    useBlurDecorator,\n    useChangeDecorator,\n    useCheckedToValue,\n    useDecorator,\n    useOnBlur,\n    useOnChange,\n    useUIDecorator\n};\n\nexport const hoc = {\n    withChecked\n};\n\nexport const widget = {\n    ScrollToError,\n    EnterSubmit,\n    MaxLabelProvider,\n    FormStore,\n    SizeProvider\n};\n\nexport const utils = {isElementInViewport};\n\nconst api = {\n    hooks, hoc, widget, utils\n};\n\nexport default api;\n\n"]},"metadata":{},"sourceType":"module"}