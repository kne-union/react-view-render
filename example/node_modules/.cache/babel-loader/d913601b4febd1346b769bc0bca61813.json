{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = t(require(\"prop-types\"), require(\"react\")) : \"function\" == typeof define && define.amd ? define([\"prop-types\", \"react\"], t) : e.AvatarEditor = t(e.PropTypes, e.React);\n}(this, function (e, t) {\n  \"use strict\";\n\n  function n(e, t) {\n    return new Promise(function (n, i) {\n      var o,\n          a = new Image();\n      a.onload = function () {\n        return n(a);\n      }, a.onerror = i, !1 == (null !== (o = e) && !!o.match(/^\\s*data:([a-z]+\\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\\-._~:@/?%\\s]*\\s*$/i)) && t && (a.crossOrigin = t), a.src = e;\n    });\n  }\n\n  e = e && e.hasOwnProperty(\"default\") ? e.default : e, t = t && t.hasOwnProperty(\"default\") ? t.default : t;\n\n  var i = function i(e, t) {\n    if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n  },\n      o = function () {\n    function e(e, t) {\n      for (var n = 0; n < t.length; n++) {\n        var i = t[n];\n        i.enumerable = i.enumerable || !1, i.configurable = !0, \"value\" in i && (i.writable = !0), Object.defineProperty(e, i.key, i);\n      }\n    }\n\n    return function (t, n, i) {\n      return n && e(t.prototype, n), i && e(t, i), t;\n    };\n  }(),\n      a = Object.assign || function (e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var n = arguments[t];\n\n      for (var i in n) {\n        Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);\n      }\n    }\n\n    return e;\n  },\n      r = function r(e, t) {\n    if (!e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    return !t || \"object\" != typeof t && \"function\" != typeof t ? e : t;\n  },\n      s = function () {\n    return function (e, t) {\n      if (Array.isArray(e)) return e;\n      if (Symbol.iterator in Object(e)) return function (e, t) {\n        var n = [],\n            i = !0,\n            o = !1,\n            a = void 0;\n\n        try {\n          for (var r, s = e[Symbol.iterator](); !(i = (r = s.next()).done) && (n.push(r.value), !t || n.length !== t); i = !0) {\n            ;\n          }\n        } catch (e) {\n          o = !0, a = e;\n        } finally {\n          try {\n            !i && s.return && s.return();\n          } finally {\n            if (o) throw a;\n          }\n        }\n\n        return n;\n      }(e, t);\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    };\n  }(),\n      h = function h(e) {\n    var t = !1;\n    return {\n      promise: new Promise(function (n, i) {\n        e.then(function (e) {\n          return t ? i({\n            isCanceled: !0\n          }) : n(e);\n        }, function (e) {\n          return i(t ? {\n            isCanceled: !0\n          } : e);\n        });\n      }),\n      cancel: function cancel() {\n        t = !0;\n      }\n    };\n  },\n      u = !(\"undefined\" == typeof window || \"undefined\" == typeof navigator || !(\"ontouchstart\" in window || navigator.msMaxTouchPoints > 0)),\n      c = \"undefined\" != typeof File,\n      d = {\n    touch: {\n      react: {\n        down: \"onTouchStart\",\n        mouseDown: \"onMouseDown\",\n        drag: \"onTouchMove\",\n        move: \"onTouchMove\",\n        mouseMove: \"onMouseMove\",\n        up: \"onTouchEnd\",\n        mouseUp: \"onMouseUp\"\n      },\n      native: {\n        down: \"touchstart\",\n        mouseDown: \"mousedown\",\n        drag: \"touchmove\",\n        move: \"touchmove\",\n        mouseMove: \"mousemove\",\n        up: \"touchend\",\n        mouseUp: \"mouseup\"\n      }\n    },\n    desktop: {\n      react: {\n        down: \"onMouseDown\",\n        drag: \"onDragOver\",\n        move: \"onMouseMove\",\n        up: \"onMouseUp\"\n      },\n      native: {\n        down: \"mousedown\",\n        drag: \"dragStart\",\n        move: \"mousemove\",\n        up: \"mouseup\"\n      }\n    }\n  },\n      l = u ? d.touch : d.desktop,\n      g = \"undefined\" != typeof window && window.devicePixelRatio ? window.devicePixelRatio : 1,\n      p = {\n    x: .5,\n    y: .5\n  },\n      m = function (e) {\n    function d(e) {\n      i(this, d);\n      var t = r(this, (d.__proto__ || Object.getPrototypeOf(d)).call(this, e));\n      return t.state = {\n        drag: !1,\n        my: null,\n        mx: null,\n        image: p\n      }, t.handleImageReady = function (e) {\n        var n = t.getInitialSize(e.width, e.height);\n        n.resource = e, n.x = .5, n.y = .5, t.setState({\n          drag: !1,\n          image: n\n        }, t.props.onImageReady), t.props.onLoadSuccess(n);\n      }, t.clearImage = function () {\n        t.canvas.getContext(\"2d\").clearRect(0, 0, t.canvas.width, t.canvas.height), t.setState({\n          image: p\n        });\n      }, t.handleMouseDown = function (e) {\n        (e = e || window.event).preventDefault(), t.setState({\n          drag: !0,\n          mx: null,\n          my: null\n        });\n      }, t.handleMouseUp = function () {\n        t.state.drag && (t.setState({\n          drag: !1\n        }), t.props.onMouseUp());\n      }, t.handleMouseMove = function (e) {\n        if (e = e || window.event, !1 !== t.state.drag) {\n          e.preventDefault();\n          var n = e.targetTouches ? e.targetTouches[0].pageX : e.clientX,\n              i = e.targetTouches ? e.targetTouches[0].pageY : e.clientY,\n              o = {\n            mx: n,\n            my: i\n          },\n              r = t.props.rotate;\n\n          if (r = (r %= 360) < 0 ? r + 360 : r, t.state.mx && t.state.my) {\n            var s = t.state.mx - n,\n                h = t.state.my - i,\n                u = t.state.image.width * t.props.scale,\n                c = t.state.image.height * t.props.scale,\n                d = t.getCroppingRect(),\n                l = d.x,\n                g = d.y;\n            l *= u, g *= c;\n\n            var p = function p(e) {\n              return e * (Math.PI / 180);\n            },\n                m = Math.cos(p(r)),\n                v = Math.sin(p(r)),\n                f = g + -s * v + h * m,\n                y = {\n              x: (l + s * m + h * v) / u + 1 / t.props.scale * t.getXScale() / 2,\n              y: f / c + 1 / t.props.scale * t.getYScale() / 2\n            };\n\n            t.props.onPositionChange(y), o.image = a({}, t.state.image, y);\n          }\n\n          t.setState(o), t.props.onMouseMove(e);\n        }\n      }, t.setCanvas = function (e) {\n        t.canvas = e;\n      }, t.canvas = null, t;\n    }\n\n    return function (e, t) {\n      if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function, not \" + typeof t);\n      e.prototype = Object.create(t && t.prototype, {\n        constructor: {\n          value: e,\n          enumerable: !1,\n          writable: !0,\n          configurable: !0\n        }\n      }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);\n    }(d, t.Component), o(d, [{\n      key: \"componentDidMount\",\n      value: function value() {\n        this.props.disableHiDPIScaling && (g = 1);\n        var e = this.canvas.getContext(\"2d\");\n\n        if (this.props.image && this.loadImage(this.props.image), this.paint(e), document) {\n          var t = !!function () {\n            var e = !1;\n\n            try {\n              var t = Object.defineProperty({}, \"passive\", {\n                get: function get() {\n                  e = !0;\n                }\n              });\n              window.addEventListener(\"test\", t, t), window.removeEventListener(\"test\", t, t);\n            } catch (t) {\n              e = !1;\n            }\n\n            return e;\n          }() && {\n            passive: !1\n          },\n              n = l.native;\n          document.addEventListener(n.move, this.handleMouseMove, t), document.addEventListener(n.up, this.handleMouseUp, t), u && (document.addEventListener(n.mouseMove, this.handleMouseMove, t), document.addEventListener(n.mouseUp, this.handleMouseUp, t));\n        }\n      }\n    }, {\n      key: \"componentWillReceiveProps\",\n      value: function value(e) {\n        e.image && this.props.image !== e.image || this.props.width !== e.width || this.props.height !== e.height ? this.loadImage(e.image) : e.image || this.clearImage();\n      }\n    }, {\n      key: \"componentDidUpdate\",\n      value: function value(e, t) {\n        var n = this.canvas.getContext(\"2d\");\n        n.clearRect(0, 0, this.canvas.width, this.canvas.height), this.paint(n), this.paintImage(n, this.state.image, this.props.border), e.image === this.props.image && e.width === this.props.width && e.height === this.props.height && e.position === this.props.position && e.scale === this.props.scale && e.rotate === this.props.rotate && t.my === this.state.my && t.mx === this.state.mx && t.image.x === this.state.image.x && t.image.y === this.state.image.y || this.props.onImageChange();\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function value() {\n        if (document) {\n          var e = l.native;\n          document.removeEventListener(e.move, this.handleMouseMove, !1), document.removeEventListener(e.up, this.handleMouseUp, !1), u && (document.removeEventListener(e.mouseMove, this.handleMouseMove, !1), document.removeEventListener(e.mouseUp, this.handleMouseUp, !1));\n        }\n      }\n    }, {\n      key: \"isVertical\",\n      value: function value() {\n        return this.props.rotate % 180 != 0;\n      }\n    }, {\n      key: \"getBorders\",\n      value: function value() {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.props.border;\n        return Array.isArray(e) ? e : [e, e];\n      }\n    }, {\n      key: \"getDimensions\",\n      value: function value() {\n        var e = this.props,\n            t = e.width,\n            n = e.height,\n            i = e.rotate,\n            o = e.border,\n            a = {},\n            r = this.getBorders(o),\n            h = s(r, 2),\n            u = h[0],\n            c = h[1],\n            d = t,\n            l = n;\n        return this.isVertical() ? (a.width = l, a.height = d) : (a.width = d, a.height = l), a.width += 2 * u, a.height += 2 * c, {\n          canvas: a,\n          rotate: i,\n          width: t,\n          height: n,\n          border: o\n        };\n      }\n    }, {\n      key: \"getImage\",\n      value: function value() {\n        var e = this.getCroppingRect(),\n            t = this.state.image;\n        e.x *= t.resource.width, e.y *= t.resource.height, e.width *= t.resource.width, e.height *= t.resource.height;\n        var n = document.createElement(\"canvas\");\n        this.isVertical() ? (n.width = e.height, n.height = e.width) : (n.width = e.width, n.height = e.height);\n        var i = n.getContext(\"2d\");\n        return i.translate(n.width / 2, n.height / 2), i.rotate(this.props.rotate * Math.PI / 180), i.translate(-n.width / 2, -n.height / 2), this.isVertical() && i.translate((n.width - n.height) / 2, (n.height - n.width) / 2), i.drawImage(t.resource, -e.x, -e.y), n;\n      }\n    }, {\n      key: \"getImageScaledToCanvas\",\n      value: function value() {\n        var e = this.getDimensions(),\n            t = e.width,\n            n = e.height,\n            i = document.createElement(\"canvas\");\n        return this.isVertical() ? (i.width = n, i.height = t) : (i.width = t, i.height = n), this.paintImage(i.getContext(\"2d\"), this.state.image, 0, 1), i;\n      }\n    }, {\n      key: \"getXScale\",\n      value: function value() {\n        var e = this.props.width / this.props.height,\n            t = this.state.image.width / this.state.image.height;\n        return Math.min(1, e / t);\n      }\n    }, {\n      key: \"getYScale\",\n      value: function value() {\n        var e = this.props.height / this.props.width,\n            t = this.state.image.height / this.state.image.width;\n        return Math.min(1, e / t);\n      }\n    }, {\n      key: \"getCroppingRect\",\n      value: function value() {\n        var e = this.props.position || {\n          x: this.state.image.x,\n          y: this.state.image.y\n        },\n            t = 1 / this.props.scale * this.getXScale(),\n            n = 1 / this.props.scale * this.getYScale(),\n            i = {\n          x: e.x - t / 2,\n          y: e.y - n / 2,\n          width: t,\n          height: n\n        },\n            o = 0,\n            r = 1 - i.width,\n            s = 0,\n            h = 1 - i.height;\n        return (this.props.disableBoundaryChecks || t > 1 || n > 1) && (o = -i.width, r = 1, s = -i.height, h = 1), a({}, i, {\n          x: Math.max(o, Math.min(i.x, r)),\n          y: Math.max(s, Math.min(i.y, h))\n        });\n      }\n    }, {\n      key: \"loadImage\",\n      value: function value(e) {\n        var t;\n        c && e instanceof File ? this.loadingImage = h((t = e, new Promise(function (e, i) {\n          var o = new FileReader();\n          o.onload = function (t) {\n            try {\n              var o = n(t.target.result);\n              e(o);\n            } catch (t) {\n              i(t);\n            }\n          }, o.readAsDataURL(t);\n        }))).promise.then(this.handleImageReady).catch(this.props.onLoadFailure) : \"string\" == typeof e && (this.loadingImage = h(n(e, this.props.crossOrigin)).promise.then(this.handleImageReady).catch(this.props.onLoadFailure));\n      }\n    }, {\n      key: \"getInitialSize\",\n      value: function value(e, t) {\n        var n = void 0,\n            i = void 0,\n            o = this.getDimensions();\n        return o.height / o.width > t / e ? i = e * ((n = this.getDimensions().height) / t) : n = t * ((i = this.getDimensions().width) / e), {\n          height: n,\n          width: i\n        };\n      }\n    }, {\n      key: \"paintImage\",\n      value: function value(e, t, n) {\n        var i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : g;\n\n        if (t.resource) {\n          var o = this.calculatePosition(t, n);\n          e.save(), e.translate(e.canvas.width / 2, e.canvas.height / 2), e.rotate(this.props.rotate * Math.PI / 180), e.translate(-e.canvas.width / 2, -e.canvas.height / 2), this.isVertical() && e.translate((e.canvas.width - e.canvas.height) / 2, (e.canvas.height - e.canvas.width) / 2), e.scale(i, i), e.globalCompositeOperation = \"destination-over\", e.drawImage(t.resource, o.x, o.y, o.width, o.height), e.restore();\n        }\n      }\n    }, {\n      key: \"calculatePosition\",\n      value: function value(e, t) {\n        e = e || this.state.image;\n        var n = this.getBorders(t),\n            i = s(n, 2),\n            o = i[0],\n            a = i[1],\n            r = this.getCroppingRect(),\n            h = e.width * this.props.scale,\n            u = e.height * this.props.scale,\n            c = -r.x * h,\n            d = -r.y * u;\n        return this.isVertical() ? (c += a, d += o) : (c += o, d += a), {\n          x: c,\n          y: d,\n          height: u,\n          width: h\n        };\n      }\n    }, {\n      key: \"paint\",\n      value: function value(e) {\n        e.save(), e.scale(g, g), e.translate(0, 0), e.fillStyle = \"rgba(\" + this.props.color.slice(0, 4).join(\",\") + \")\";\n        var t = this.props.borderRadius,\n            n = this.getDimensions(),\n            i = this.getBorders(n.border),\n            o = s(i, 2),\n            a = o[0],\n            r = o[1],\n            h = n.canvas.height,\n            u = n.canvas.width;\n        t = Math.max(t, 0), t = Math.min(t, u / 2 - a, h / 2 - r), e.beginPath(), function (e, t, n, i, o, a) {\n          if (0 === a) e.rect(t, n, i, o);else {\n            var r = i - a,\n                s = o - a;\n            e.translate(t, n), e.arc(a, a, a, Math.PI, 1.5 * Math.PI), e.lineTo(r, 0), e.arc(r, a, a, 1.5 * Math.PI, 2 * Math.PI), e.lineTo(i, s), e.arc(r, s, a, 2 * Math.PI, .5 * Math.PI), e.lineTo(a, o), e.arc(a, s, a, .5 * Math.PI, Math.PI), e.translate(-t, -n);\n          }\n        }(e, a, r, u - 2 * a, h - 2 * r, t), e.rect(u, 0, -u, h), e.fill(\"evenodd\"), e.restore();\n      }\n    }, {\n      key: \"render\",\n      value: function value() {\n        var e = this.props,\n            n = (e.scale, e.rotate, e.image, e.border, e.borderRadius, e.width, e.height, e.position, e.color, e.style),\n            i = (e.crossOrigin, e.onLoadFailure, e.onLoadSuccess, e.onImageReady, e.onImageChange, e.onMouseUp, e.onMouseMove, e.onPositionChange, e.disableBoundaryChecks, e.disableHiDPIScaling, function (e, t) {\n          var n = {};\n\n          for (var i in e) {\n            t.indexOf(i) >= 0 || Object.prototype.hasOwnProperty.call(e, i) && (n[i] = e[i]);\n          }\n\n          return n;\n        }(e, [\"scale\", \"rotate\", \"image\", \"border\", \"borderRadius\", \"width\", \"height\", \"position\", \"color\", \"style\", \"crossOrigin\", \"onLoadFailure\", \"onLoadSuccess\", \"onImageReady\", \"onImageChange\", \"onMouseUp\", \"onMouseMove\", \"onPositionChange\", \"disableBoundaryChecks\", \"disableHiDPIScaling\"])),\n            o = this.getDimensions(),\n            r = {\n          width: o.canvas.width,\n          height: o.canvas.height,\n          cursor: this.state.drag ? \"grabbing\" : \"grab\",\n          touchAction: \"none\"\n        },\n            s = {\n          width: o.canvas.width * g,\n          height: o.canvas.height * g,\n          style: a({}, r, n)\n        };\n        return s[l.react.down] = this.handleMouseDown, u && (s[l.react.mouseDown] = this.handleMouseDown), t.createElement(\"canvas\", a({\n          ref: this.setCanvas\n        }, s, i));\n      }\n    }]), d;\n  }();\n\n  return m.propTypes = {\n    scale: e.number,\n    rotate: e.number,\n    image: e.oneOfType([e.string].concat(function (e) {\n      if (Array.isArray(e)) {\n        for (var t = 0, n = Array(e.length); t < e.length; t++) {\n          n[t] = e[t];\n        }\n\n        return n;\n      }\n\n      return Array.from(e);\n    }(c ? [e.instanceOf(File)] : []))),\n    border: e.oneOfType([e.number, e.arrayOf(e.number)]),\n    borderRadius: e.number,\n    width: e.number,\n    height: e.number,\n    position: e.shape({\n      x: e.number,\n      y: e.number\n    }),\n    color: e.arrayOf(e.number),\n    crossOrigin: e.oneOf([\"\", \"anonymous\", \"use-credentials\"]),\n    onLoadFailure: e.func,\n    onLoadSuccess: e.func,\n    onImageReady: e.func,\n    onImageChange: e.func,\n    onMouseUp: e.func,\n    onMouseMove: e.func,\n    onPositionChange: e.func,\n    disableBoundaryChecks: e.bool,\n    disableHiDPIScaling: e.bool\n  }, m.defaultProps = {\n    scale: 1,\n    rotate: 0,\n    border: 25,\n    borderRadius: 0,\n    width: 200,\n    height: 200,\n    color: [0, 0, 0, .5],\n    onLoadFailure: function onLoadFailure() {},\n    onLoadSuccess: function onLoadSuccess() {},\n    onImageReady: function onImageReady() {},\n    onImageChange: function onImageChange() {},\n    onMouseUp: function onMouseUp() {},\n    onMouseMove: function onMouseMove() {},\n    onPositionChange: function onPositionChange() {},\n    disableBoundaryChecks: !1,\n    disableHiDPIScaling: !1\n  }, m;\n});","map":{"version":3,"sources":["/Users/linzhipeng/Documents/code_cloud/@kne/react-view-render/node_modules/react-avatar-editor/dist/index.js"],"names":["e","t","exports","module","require","define","amd","AvatarEditor","PropTypes","React","n","Promise","i","o","a","Image","onload","onerror","match","crossOrigin","src","hasOwnProperty","default","TypeError","length","enumerable","configurable","writable","Object","defineProperty","key","prototype","assign","arguments","call","r","ReferenceError","s","Array","isArray","Symbol","iterator","next","done","push","value","return","h","promise","then","isCanceled","cancel","u","window","navigator","msMaxTouchPoints","c","File","d","touch","react","down","mouseDown","drag","move","mouseMove","up","mouseUp","native","desktop","l","g","devicePixelRatio","p","x","y","m","__proto__","getPrototypeOf","state","my","mx","image","handleImageReady","getInitialSize","width","height","resource","setState","props","onImageReady","onLoadSuccess","clearImage","canvas","getContext","clearRect","handleMouseDown","event","preventDefault","handleMouseUp","onMouseUp","handleMouseMove","targetTouches","pageX","clientX","pageY","clientY","rotate","scale","getCroppingRect","Math","PI","cos","v","sin","f","getXScale","getYScale","onPositionChange","onMouseMove","setCanvas","create","constructor","setPrototypeOf","Component","disableHiDPIScaling","loadImage","paint","document","get","addEventListener","removeEventListener","passive","paintImage","border","position","onImageChange","getBorders","isVertical","createElement","translate","drawImage","getDimensions","min","disableBoundaryChecks","max","loadingImage","FileReader","target","result","readAsDataURL","catch","onLoadFailure","calculatePosition","save","globalCompositeOperation","restore","fillStyle","color","slice","join","borderRadius","beginPath","rect","arc","lineTo","fill","style","indexOf","cursor","touchAction","ref","propTypes","number","oneOfType","string","concat","from","instanceOf","arrayOf","shape","oneOf","func","bool","defaultProps"],"mappings":"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","sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t(require(\"prop-types\"),require(\"react\")):\"function\"==typeof define&&define.amd?define([\"prop-types\",\"react\"],t):e.AvatarEditor=t(e.PropTypes,e.React)}(this,function(e,t){\"use strict\";function n(e,t){return new Promise(function(n,i){var o,a=new Image;a.onload=function(){return n(a)},a.onerror=i,!1==(null!==(o=e)&&!!o.match(/^\\s*data:([a-z]+\\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\\-._~:@/?%\\s]*\\s*$/i))&&t&&(a.crossOrigin=t),a.src=e})}e=e&&e.hasOwnProperty(\"default\")?e.default:e,t=t&&t.hasOwnProperty(\"default\")?t.default:t;var i=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t},s=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),h=function(e){var t=!1;return{promise:new Promise(function(n,i){e.then(function(e){return t?i({isCanceled:!0}):n(e)},function(e){return i(t?{isCanceled:!0}:e)})}),cancel:function(){t=!0}}},u=!(\"undefined\"==typeof window||\"undefined\"==typeof navigator||!(\"ontouchstart\"in window||navigator.msMaxTouchPoints>0)),c=\"undefined\"!=typeof File,d={touch:{react:{down:\"onTouchStart\",mouseDown:\"onMouseDown\",drag:\"onTouchMove\",move:\"onTouchMove\",mouseMove:\"onMouseMove\",up:\"onTouchEnd\",mouseUp:\"onMouseUp\"},native:{down:\"touchstart\",mouseDown:\"mousedown\",drag:\"touchmove\",move:\"touchmove\",mouseMove:\"mousemove\",up:\"touchend\",mouseUp:\"mouseup\"}},desktop:{react:{down:\"onMouseDown\",drag:\"onDragOver\",move:\"onMouseMove\",up:\"onMouseUp\"},native:{down:\"mousedown\",drag:\"dragStart\",move:\"mousemove\",up:\"mouseup\"}}},l=u?d.touch:d.desktop,g=\"undefined\"!=typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,p={x:.5,y:.5},m=function(e){function d(e){i(this,d);var t=r(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return t.state={drag:!1,my:null,mx:null,image:p},t.handleImageReady=function(e){var n=t.getInitialSize(e.width,e.height);n.resource=e,n.x=.5,n.y=.5,t.setState({drag:!1,image:n},t.props.onImageReady),t.props.onLoadSuccess(n)},t.clearImage=function(){t.canvas.getContext(\"2d\").clearRect(0,0,t.canvas.width,t.canvas.height),t.setState({image:p})},t.handleMouseDown=function(e){(e=e||window.event).preventDefault(),t.setState({drag:!0,mx:null,my:null})},t.handleMouseUp=function(){t.state.drag&&(t.setState({drag:!1}),t.props.onMouseUp())},t.handleMouseMove=function(e){if(e=e||window.event,!1!==t.state.drag){e.preventDefault();var n=e.targetTouches?e.targetTouches[0].pageX:e.clientX,i=e.targetTouches?e.targetTouches[0].pageY:e.clientY,o={mx:n,my:i},r=t.props.rotate;if(r=(r%=360)<0?r+360:r,t.state.mx&&t.state.my){var s=t.state.mx-n,h=t.state.my-i,u=t.state.image.width*t.props.scale,c=t.state.image.height*t.props.scale,d=t.getCroppingRect(),l=d.x,g=d.y;l*=u,g*=c;var p=function(e){return e*(Math.PI/180)},m=Math.cos(p(r)),v=Math.sin(p(r)),f=g+-s*v+h*m,y={x:(l+s*m+h*v)/u+1/t.props.scale*t.getXScale()/2,y:f/c+1/t.props.scale*t.getYScale()/2};t.props.onPositionChange(y),o.image=a({},t.state.image,y)}t.setState(o),t.props.onMouseMove(e)}},t.setCanvas=function(e){t.canvas=e},t.canvas=null,t}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,t.Component),o(d,[{key:\"componentDidMount\",value:function(){this.props.disableHiDPIScaling&&(g=1);var e=this.canvas.getContext(\"2d\");if(this.props.image&&this.loadImage(this.props.image),this.paint(e),document){var t=!!function(){var e=!1;try{var t=Object.defineProperty({},\"passive\",{get:function(){e=!0}});window.addEventListener(\"test\",t,t),window.removeEventListener(\"test\",t,t)}catch(t){e=!1}return e}()&&{passive:!1},n=l.native;document.addEventListener(n.move,this.handleMouseMove,t),document.addEventListener(n.up,this.handleMouseUp,t),u&&(document.addEventListener(n.mouseMove,this.handleMouseMove,t),document.addEventListener(n.mouseUp,this.handleMouseUp,t))}}},{key:\"componentWillReceiveProps\",value:function(e){e.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height?this.loadImage(e.image):e.image||this.clearImage()}},{key:\"componentDidUpdate\",value:function(e,t){var n=this.canvas.getContext(\"2d\");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.paint(n),this.paintImage(n,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y||this.props.onImageChange()}},{key:\"componentWillUnmount\",value:function(){if(document){var e=l.native;document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),u&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1))}}},{key:\"isVertical\",value:function(){return this.props.rotate%180!=0}},{key:\"getBorders\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.border;return Array.isArray(e)?e:[e,e]}},{key:\"getDimensions\",value:function(){var e=this.props,t=e.width,n=e.height,i=e.rotate,o=e.border,a={},r=this.getBorders(o),h=s(r,2),u=h[0],c=h[1],d=t,l=n;return this.isVertical()?(a.width=l,a.height=d):(a.width=d,a.height=l),a.width+=2*u,a.height+=2*c,{canvas:a,rotate:i,width:t,height:n,border:o}}},{key:\"getImage\",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var n=document.createElement(\"canvas\");this.isVertical()?(n.width=e.height,n.height=e.width):(n.width=e.width,n.height=e.height);var i=n.getContext(\"2d\");return i.translate(n.width/2,n.height/2),i.rotate(this.props.rotate*Math.PI/180),i.translate(-n.width/2,-n.height/2),this.isVertical()&&i.translate((n.width-n.height)/2,(n.height-n.width)/2),i.drawImage(t.resource,-e.x,-e.y),n}},{key:\"getImageScaledToCanvas\",value:function(){var e=this.getDimensions(),t=e.width,n=e.height,i=document.createElement(\"canvas\");return this.isVertical()?(i.width=n,i.height=t):(i.width=t,i.height=n),this.paintImage(i.getContext(\"2d\"),this.state.image,0,1),i}},{key:\"getXScale\",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:\"getYScale\",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:\"getCroppingRect\",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),n=1/this.props.scale*this.getYScale(),i={x:e.x-t/2,y:e.y-n/2,width:t,height:n},o=0,r=1-i.width,s=0,h=1-i.height;return(this.props.disableBoundaryChecks||t>1||n>1)&&(o=-i.width,r=1,s=-i.height,h=1),a({},i,{x:Math.max(o,Math.min(i.x,r)),y:Math.max(s,Math.min(i.y,h))})}},{key:\"loadImage\",value:function(e){var t;c&&e instanceof File?this.loadingImage=h((t=e,new Promise(function(e,i){var o=new FileReader;o.onload=function(t){try{var o=n(t.target.result);e(o)}catch(t){i(t)}},o.readAsDataURL(t)}))).promise.then(this.handleImageReady).catch(this.props.onLoadFailure):\"string\"==typeof e&&(this.loadingImage=h(n(e,this.props.crossOrigin)).promise.then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:\"getInitialSize\",value:function(e,t){var n=void 0,i=void 0,o=this.getDimensions();return o.height/o.width>t/e?i=e*((n=this.getDimensions().height)/t):n=t*((i=this.getDimensions().width)/e),{height:n,width:i}}},{key:\"paintImage\",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g;if(t.resource){var o=this.calculatePosition(t,n);e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(i,i),e.globalCompositeOperation=\"destination-over\",e.drawImage(t.resource,o.x,o.y,o.width,o.height),e.restore()}}},{key:\"calculatePosition\",value:function(e,t){e=e||this.state.image;var n=this.getBorders(t),i=s(n,2),o=i[0],a=i[1],r=this.getCroppingRect(),h=e.width*this.props.scale,u=e.height*this.props.scale,c=-r.x*h,d=-r.y*u;return this.isVertical()?(c+=a,d+=o):(c+=o,d+=a),{x:c,y:d,height:u,width:h}}},{key:\"paint\",value:function(e){e.save(),e.scale(g,g),e.translate(0,0),e.fillStyle=\"rgba(\"+this.props.color.slice(0,4).join(\",\")+\")\";var t=this.props.borderRadius,n=this.getDimensions(),i=this.getBorders(n.border),o=s(i,2),a=o[0],r=o[1],h=n.canvas.height,u=n.canvas.width;t=Math.max(t,0),t=Math.min(t,u/2-a,h/2-r),e.beginPath(),function(e,t,n,i,o,a){if(0===a)e.rect(t,n,i,o);else{var r=i-a,s=o-a;e.translate(t,n),e.arc(a,a,a,Math.PI,1.5*Math.PI),e.lineTo(r,0),e.arc(r,a,a,1.5*Math.PI,2*Math.PI),e.lineTo(i,s),e.arc(r,s,a,2*Math.PI,.5*Math.PI),e.lineTo(a,o),e.arc(a,s,a,.5*Math.PI,Math.PI),e.translate(-t,-n)}}(e,a,r,u-2*a,h-2*r,t),e.rect(u,0,-u,h),e.fill(\"evenodd\"),e.restore()}},{key:\"render\",value:function(){var e=this.props,n=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.style),i=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,function(e,t){var n={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}(e,[\"scale\",\"rotate\",\"image\",\"border\",\"borderRadius\",\"width\",\"height\",\"position\",\"color\",\"style\",\"crossOrigin\",\"onLoadFailure\",\"onLoadSuccess\",\"onImageReady\",\"onImageChange\",\"onMouseUp\",\"onMouseMove\",\"onPositionChange\",\"disableBoundaryChecks\",\"disableHiDPIScaling\"])),o=this.getDimensions(),r={width:o.canvas.width,height:o.canvas.height,cursor:this.state.drag?\"grabbing\":\"grab\",touchAction:\"none\"},s={width:o.canvas.width*g,height:o.canvas.height*g,style:a({},r,n)};return s[l.react.down]=this.handleMouseDown,u&&(s[l.react.mouseDown]=this.handleMouseDown),t.createElement(\"canvas\",a({ref:this.setCanvas},s,i))}}]),d}();return m.propTypes={scale:e.number,rotate:e.number,image:e.oneOfType([e.string].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(c?[e.instanceOf(File)]:[]))),border:e.oneOfType([e.number,e.arrayOf(e.number)]),borderRadius:e.number,width:e.number,height:e.number,position:e.shape({x:e.number,y:e.number}),color:e.arrayOf(e.number),crossOrigin:e.oneOf([\"\",\"anonymous\",\"use-credentials\"]),onLoadFailure:e.func,onLoadSuccess:e.func,onImageReady:e.func,onImageChange:e.func,onMouseUp:e.func,onMouseMove:e.func,onPositionChange:e.func,disableBoundaryChecks:e.bool,disableHiDPIScaling:e.bool},m.defaultProps={scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1},m});\n"]},"metadata":{},"sourceType":"script"}